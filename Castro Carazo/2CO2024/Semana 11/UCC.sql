/*
DDL - DATA DEFINITION LANGUAGE - LENGUAGE DE DEFINICION DE DATOS 
CREATE
ALTER 
DROP

SINTAXIS

ACCION  ESTRUCTURA  IDENTIFICADOR(DEFINIDO POR USUARIO) PASCAL
CREATE
ALTER 
DROP

ESTRUCTURAS

TABLE 
VIEW
USER
TABLESPACE
DATAFILE
PROCEDURE
INDEX
FUNCTION 
.........

DCL - DATA CONTROL LANGUAGE - LENGUAGE DE CONTROL DE DATOS
GRANT
REVOKE

ACCION ELEMENTOSAASIGNAR AQUIEN
GRANT
REVOKE 

ELEMENTOS
SYSDBA
CONNECT..........

AQUIEN 
UCASTRO


SQL> ALTER SESSION SET "_ORACLE_SCRIPT"=TRUE;

Sesi�n modificada.

SQL> CREATE TABLESPACE UCC DATAFILE 'UCC.dbf' SIZE 20M;

Tablespace creado.

SQL> CREATE USER UCASTRO
  2  IDENTIFIED BY Basedatos123456
  3  DEFAULT TABLESPACE UCC
  4  TEMPORARY TABLESPACE TEMP
  5  QUOTA UNLIMITED ON UCC;

Usuario creado.

SQL> grant dba,connect, resource to UCASTRO;

Concesi�n terminada correctamente.
*/

CREATE TABLE PERSONA
(
    ID INT NOT NULL /*PRIMARY*/,
    NIF VARCHAR(9) NULL,
    NOMBRE VARCHAR(25) NOT NULL,
    APELLIDO1 VARCHAR(50) NOT NULL,
    APELLIDO2 VARCHAR(50) NULL,
    CIUDAD VARCHAR(25) NOT NULL,
    DIRECCION VARCHAR(50) NOT NULL,
    TELEFONO VARCHAR(9) NULL,
    FECHA_NACIMIENTO DATE NOT NULL,
    SEXO CHAR(1) NOT NULL,
    TIPO VARCHAR(10)NOT NULL,
    CONSTRAINT PK_PERSONA 
    PRIMARY KEY(ID),
    /*CHECK CONSTRAINT - VALIDACIONES EXPLICITAS  - CKC_NOMBRECOLUMNA_NOMTABLA*/
    CONSTRAINT CKC_SEXO_PERSONA
    CHECK (SEXO IN ('M','H','I')),
    CONSTRAINT CKC_TIPO_PERSONA
    CHECK (TIPO IN ('PROFESOR', 'ALUMNO'))
);


CREATE TABLE DEPARTAMENTO
(
    ID INT NOT NULL,
    NOMBRE VARCHAR(50)NOT NULL,
    CONSTRAINT PK_DEPARTAMENTO
    PRIMARY KEY(ID)
);

CREATE TABLE PROFESOR
(
    ID_PROFESOR INT NOT NULL,
    ID_DEPARTAMENTO INT NOT NULL,
    CONSTRAINT PK_PROFESOR
    PRIMARY KEY (ID_PROFESOR),
    /*FK_NOMBREHIJA_NOMBREPADRE*/
    CONSTRAINT FK_PROFESOR_PERSONA
    FOREIGN KEY (ID_PROFESOR) 
    REFERENCES PERSONA(ID),
    CONSTRAINT FK_PROFESOR_DEPARTAMENTO
    FOREIGN KEY (ID_DEPARTAMENTO)
    REFERENCES DEPARTAMENTO(ID)--ON DELETE CASCADE 
                               --ON DELETE SET NULL
);

CREATE TABLE ALUMNOXASIGNATURA
(
    ID_ALUMNO INT NOT NULL,
    ID_ASIGNATURA INT NOT NULL,
    ID_CURSO_ESCOLAR INT NOT NULL
);

/*
ALTER 
    ADD 
    MODIFY 
    DROP

*/

ALTER TABLE ALUMNOXASIGNATURA
ADD CONSTRAINT PK_ALUMNOXASIGNATURA
PRIMARY KEY(ID_ALUMNO,ID_ASIGNATURA,ID_CURSO_ESCOLAR);
/*          1           1               1
            1           1               2*/

ALTER TABLE ALUMNOXASIGNATURA 
ADD CONSTRAINT FK_ALUMNOXASIGNATURA_PERSONA
FOREIGN KEY (ID_ALUMNO) REFERENCES PERSONA(ID);

CREATE TABLE CURSO_ESCOLAR
(
    ID INT NOT NULL,
    ANIO_INICIO INT,
    ANIO_FIN    INT
);

ALTER TABLE CURSO_ESCOLAR
ADD CONSTRAINT PK_CURSO_ESCOLAR
PRIMARY KEY (ID);

ALTER TABLE ALUMNOXASIGNATURA 
ADD CONSTRAINT FK_ALUMNOXASIGNATURA_CURSO_ESCOLAR
FOREIGN KEY (ID_CURSO_ESCOLAR) REFERENCES CURSO_ESCOLAR(ID);

/*AGREGAR UNA COLUMNA A CURSO ESCOLAR*/
ALTER TABLE CURSO_ESCOLAR
ADD (DESCRIPCION VARCHAR(50) DEFAULT 'NO INDICA' NOT NULL);
/*SI YA TENGO DATOS 
    1. PERMITA NULOS
    2. NO PERMITA NULOS - VALOR DEFAULT
*/

ALTER TABLE CURSO_ESCOLAR
MODIFY (DESCRIPCION VARCHAR(20) DEFAULT 'N/I' NULL,
        ANIO_INICIO INT NOT NULL, ANIO_FIN INT NOT NULL);
        
ALTER TABLE CURSO_ESCOLAR
MODIFY (ANIO_INICIO INT NOT NULL, ANIO_FIN INT NOT NULL);


ALTER TABLE CURSO_ESCOLAR SET UNUSED (DESCRIPCION);

ALTER TABLE CURSO_ESCOLAR DROP UNUSED COLUMNS;
/*
ALTER TABLE CURSO_ESCOLAR
DROP COLUMN DESCRIPCION;
*/
SELECT * FROM CURSO_ESCOLAR;

/*DML INSERT*/
INSERT INTO CURSO_ESCOLAR(ID, ANIO_INICIO,ANIO_FIN)
VALUES(01,2022,2023);

INSERT INTO CURSO_ESCOLAR
    WITH TABLA AS
    (
        SELECT 02, 2022, 2023 FROM DUAL UNION ALL
        SELECT 03, 2022, 2024 FROM DUAL UNION ALL
        SELECT 04, 2022, 2025 FROM DUAL UNION ALL
        SELECT 05, 2022, 2026 FROM DUAL UNION ALL
        SELECT 06, 2022, 2027 FROM DUAL UNION ALL
        SELECT 07, 2022, 2028 FROM DUAL 
    )
SELECT * FROM TABLA;


CREATE TABLE GRADO
(
    ID INT GENERATED BY DEFAULT AS IDENTITY NOT NULL, 
    NOMBRE VARCHAR(100)
);


